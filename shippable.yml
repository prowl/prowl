#Build Environment
build_environment: Ubuntu 12.04

#language setting
language: node_js

node_js:
  - 0.11

# environment variables
env:
  - NODE_ENV=test
  - HIPCHAT_ROOMID=776140
  - HIPCHAT_FROM=Prowl Deploy
  - secure: SXzFaqhvjAMAQQRRN5CcOETGmkrYg86s1hriDjNT8AUhfCSNFGvBLeTIdsPwLBX3ZYl3JAnJNdyaUC41UpqUKpsLCBPC6Qc3Yl6LfaSOyF6ONbLyDeSwlzKrNVVFeaP8x5zyf35MTOPBJfMU07MerQWnCRjRsupsO84SgjYxZWBV/kzZrJ67r6bf/TKeK8LCbP5J2xlrpul3ocg1V+fH35CF4yytMAtzOt4F9K2OeHsC6OMrFA3pd3pVv3zmarRiS2jBGZ1fZRJxICVNi+wI2dUXBexJyvtNlzR1EzPpgohpFfxrTh3r0XG8lyD0wLVQiKR2JC8wYfld4hg+6lb4UA==

#notifications
notifications:
  email:
    recipients:
      - jfugett27@gmail.com
      - jfugett@thotjs.io
    on_success: change
    on_failure: always

before_install:
  npm install -g gulp

install:

before_script:

script:
  - gulp build

after_script:

after_success:
  - export HIPCHAT_MESSAGE="Prowl Deploy success (<a href="$BUILD_URL">$BUILD_NUMBER</a>)"
  - export HIPCHAT_COLOR=green
  - curl -sX POST --data "room_id=$HIPCHAT_ROOMID&from=$HIPCHAT_FROM&message=$HIPCHAT_MESSAGE&color=$HIPCHAT_COLOR" https://api.hipchat.com/v1/rooms/message?format=json&auth_token=$HIPCHAT_TOKEN

after_failure:
  - export HIPCHAT_MESSAGE="Prowl Deploy failed (<a href="$BUILD_URL">$BUILD_NUMBER</a>)"
  - export HIPCHAT_COLOR=red
  - curl -sX POST --data "room_id=$HIPCHAT_ROOMID&from=$HIPCHAT_FROM&message=$HIPCHAT_MESSAGE&color=$HIPCHAT_COLOR&notify=1" https://api.hipchat.com/v1/rooms/message?format=json&auth_token=$HIPCHAT_TOKEN

before_archive:

after_archive:
  - echo $ARTIFACTS_UPLOAD_SUCCESSFUL
  - echo $SHIPPABLE_ARTIFACTS_URL